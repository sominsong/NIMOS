//user@ubuntu-18-04-vm:~$ cat exchange.c
#define _GNU_SOURCE
#include <fcntl.h>
#include <stdio.h>
#include <unistd.h>
#include <err.h>
#include <sys/syscall.h>
int main(int argc, char **argv) {
        char *base = argv[1], *p1 = argv[2], *p2 = argv[3];
        if (chdir(base)) return -1;
        while (1) {
                if (syscall(__NR_renameat2, AT_FDCWD, p1, AT_FDCWD, p2, 2))
                        return -1;
        }
}
//user@ubuntu-18-04-vm:~$ gcc -o exchange exchange.c -O2
//user@ubuntu-18-04-vm:~$ ./exchange /var/lib/test_service foo foo2